<!doctype html>
<!--[if lt IE 7 ]><html itemscope itemtype="http://schema.org/Organization" id="ie6" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 7 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie7" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 8 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie8" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 9 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie9" class="ie" lang="en-US"><![endif]-->
<!--[if gt IE 9]><!--><html itemscope itemtype="http://schema.org/Organization" lang="en-US"><!--<![endif]-->
<head>

    <!-- Meta -->
    <meta charset="utf-8">
    <title>Matching Options - Smart Mastering</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Favicons -->
    <link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64 96x96" href="/smart-mastering-core/favicon.ico">
    <meta name="application-name" content="Smart Mastering - A Smart Mastering framework for MarkLogic">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-6638631-15', 'auto');
      ga('send', 'pageview');

    </script>

    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
    document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1879746318909687'); // Insert your pixel ID here.
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1879746318909687&ev=PageView&noscript=1"
    /></noscript>
    <!-- DO NOT MODIFY -->
    <!-- End Facebook Pixel Code -->
    <link type="text/css" rel="stylesheet" href="/smart-mastering-core/assets/bundle.css">
</head>
<body class="">

    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/smart-mastering-core">
                  <span class="logo">
                    <img src="/smart-mastering-core/images/logo-marklogic.svg" width="180px" height="38px" alt="MarkLogic" title="MarkLogic" scale="0">
                  </span>
                  Smart Mastering
                  <img src="/smart-mastering-core/images/smart-mastering.svg" width="36x" height="36px">
                </a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    
                        <li  >
                            
                            <a href="/smart-mastering-core/">Getting Started</a>
                            
                        </li>
                    
                        <li  >
                            
                            <a href="https://docs.marklogic.com/datahub/">Data Hub 5</a>
                            
                        </li>
                    
                        <li  >
                            
                            <a href="https://github.com/marklogic-community/smart-mastering-core">GitHub</a>
                            
                        </li>
                    
                </ul>
            </div>
        </div>
    </nav>




  <article>
    <div class="container">
      <div class="row">
        <div class="side-nav col-md-3 hide-small">
          <div class="panel panel-default">
  <div class="panel-heading">Navigation</div>
  <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/">Getting Started</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/how-does-it-work/">How Does it Work?</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/how-to-use/">How do I Use it?</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/">Docs</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/rest/">REST API</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/libraries/">Libraries</a>
    
    
  </li>
  
  <li  class="list-group-item active"  >
    
    <a href="/smart-mastering-core/docs/matching-options/">Matching Options</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/match-algorithms/">Included Matching Algorithms</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/custom-match-algorithms/">Custom Matching Algorithms</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/actions/">Included Actions</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/custom-actions/">Custom Actions</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/merging-options/">Merging Options</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/merge-algorithms/">Included Merging Algorithms</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/custom-merge-algorithms/">Custom Merging Algorithms</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/managing-code/">Managing Custom Code</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/security/">Security</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/docs/error-codes/">Error Codes</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/faqs/">FAQs</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/smart-mastering-core/troubleshooting/">Troubleshooting</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="https://github.com/marklogic-community/smart-mastering-core">Smart Mastering on GitHub</a>
    
    
  </li>
  
</ul>

</div>

        </div>
        <div class="col-md-9">
          <h1 id="matching-options">Matching Options</h1>

<p>Smart Mastering Core offers a configuration-driven matching capability. The
match process starts with a document (referred to as the “candidate” document)
and looks for other documents that might describe the same entity. Match
configuration includes the properties to look for, how to compare them, and what
thresholds to use for taking action on the matches. Only the properties listed
under the <code class="highlighter-rouge">scoring</code> element will be used to find and score potential matches. 
The match process returns a relevance-ranked sequence of potential matches, based 
on the weights you specify.</p>

<h2 id="configuring-options">Configuring Options</h2>

<p>Here’s an example of XML match configuration options.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;options</span> <span class="na">xmlns=</span><span class="s">"http://marklogic.com/smart-mastering/matcher"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;property-defs&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">namespace=</span><span class="s">""</span> <span class="na">localname=</span><span class="s">"IdentificationID"</span> <span class="na">name=</span><span class="s">"ssn"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">namespace=</span><span class="s">""</span> <span class="na">localname=</span><span class="s">"PersonGivenName"</span> <span class="na">name=</span><span class="s">"first-name"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">namespace=</span><span class="s">""</span> <span class="na">localname=</span><span class="s">"PersonSurName"</span> <span class="na">name=</span><span class="s">"last-name"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;cts:element-reference</span> <span class="na">xmlns:cts=</span><span class="s">"http://marklogic.com/cts"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;cts:namespace-uri/&gt;</span>
        <span class="nt">&lt;cts:localname&gt;</span>PersonSurName<span class="nt">&lt;/cts:localname&gt;</span>
        <span class="nt">&lt;cts:scalar-type&gt;</span>string<span class="nt">&lt;/cts:scalar-type&gt;</span>
        <span class="nt">&lt;cts:collation&gt;</span>http://marklogic.com/collation//S1<span class="nt">&lt;/cts:collation&gt;</span>
      <span class="nt">&lt;/cts:element-reference&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">namespace=</span><span class="s">""</span> <span class="na">localname=</span><span class="s">"AddressPrivateMailboxText"</span> <span class="na">name=</span><span class="s">"addr1"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">namespace=</span><span class="s">""</span> <span class="na">localname=</span><span class="s">"LocationCity"</span> <span class="na">name=</span><span class="s">"city"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">namespace=</span><span class="s">""</span> <span class="na">localname=</span><span class="s">"LocationState"</span> <span class="na">name=</span><span class="s">"state"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">namespace=</span><span class="s">""</span> <span class="na">localname=</span><span class="s">"LocationPostalCode"</span> <span class="na">name=</span><span class="s">"zip"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/property-defs&gt;</span>
  <span class="c">&lt;!-- optional collection override. below are the default values. --&gt;</span>
  <span class="nt">&lt;collections&gt;</span>
    <span class="nt">&lt;content&gt;</span>mdm-content<span class="nt">&lt;/content&gt;</span>
  <span class="nt">&lt;/collections&gt;</span>
  <span class="nt">&lt;algorithms&gt;</span>
    <span class="nt">&lt;algorithm</span> <span class="na">name=</span><span class="s">"std-reduce"</span> <span class="na">function=</span><span class="s">"standard-reduction"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;algorithm</span> <span class="na">name=</span><span class="s">"dbl-metaphone"</span> <span class="na">function=</span><span class="s">"double-metaphone"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;algorithm</span> <span class="na">name=</span><span class="s">"thesaurus"</span> <span class="na">function=</span><span class="s">"thesaurus"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/algorithms&gt;</span>
  <span class="nt">&lt;scoring&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"ssn"</span> <span class="na">weight=</span><span class="s">"50"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"last-name"</span> <span class="na">weight=</span><span class="s">"8"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"first-name"</span> <span class="na">weight=</span><span class="s">"6"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"addr1"</span> <span class="na">weight=</span><span class="s">"5"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"city"</span> <span class="na">weight=</span><span class="s">"3"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"state"</span> <span class="na">weight=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"zip"</span> <span class="na">weight=</span><span class="s">"3"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;expand</span> <span class="na">property-name=</span><span class="s">"first-name"</span> <span class="na">algorithm-ref=</span><span class="s">"thesaurus"</span> <span class="na">weight=</span><span class="s">"6"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;thesaurus&gt;</span>/mdm/config/thesauri/first-name-synonyms.xml<span class="nt">&lt;/thesaurus&gt;</span>
      <span class="nt">&lt;distance-threshold&gt;</span>50<span class="nt">&lt;/distance-threshold&gt;</span>
    <span class="nt">&lt;/expand&gt;</span>
    <span class="nt">&lt;expand</span> <span class="na">property-name=</span><span class="s">"last-name"</span> <span class="na">algorithm-ref=</span><span class="s">"dbl-metaphone"</span> <span class="na">weight=</span><span class="s">"8"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;dictionary&gt;</span>name-dictionary.xml<span class="nt">&lt;/dictionary&gt;</span>
      <span class="c">&lt;!--defaults to 100 distance --&gt;</span>
    <span class="nt">&lt;/expand&gt;</span>
    <span class="nt">&lt;reduce</span> <span class="na">algorithm-ref=</span><span class="s">"std-reduce"</span> <span class="na">weight=</span><span class="s">"4"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;all-match&gt;</span>
        <span class="nt">&lt;property&gt;</span>last-name<span class="nt">&lt;/property&gt;</span>
        <span class="nt">&lt;property&gt;</span>addr1<span class="nt">&lt;/property&gt;</span>
      <span class="nt">&lt;/all-match&gt;</span>
    <span class="nt">&lt;/reduce&gt;</span>
  <span class="nt">&lt;/scoring&gt;</span>
  <span class="nt">&lt;actions&gt;</span>
    <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">"my-custom-action"</span> <span class="na">function=</span><span class="s">"custom-action"</span> <span class="na">namespace=</span><span class="s">"http://marklogic.com/smart-mastering/action"</span> <span class="na">at=</span><span class="s">"/custom-action.xqy"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/actions&gt;</span>
  <span class="nt">&lt;thresholds&gt;</span>
    <span class="nt">&lt;threshold</span> <span class="na">above=</span><span class="s">"30"</span> <span class="na">label=</span><span class="s">"Possible Match"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;threshold</span> <span class="na">above=</span><span class="s">"50"</span> <span class="na">label=</span><span class="s">"Likely Match"</span> <span class="na">action=</span><span class="s">"notify"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;threshold</span> <span class="na">above=</span><span class="s">"68"</span> <span class="na">label=</span><span class="s">"Definitive Match"</span> <span class="na">action=</span><span class="s">"merge"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;threshold</span> <span class="na">above=</span><span class="s">"75"</span> <span class="na">label=</span><span class="s">"Custom Match"</span> <span class="na">action=</span><span class="s">"my-custom-action"</span><span class="nt">/&gt;</span>
    <span class="c">&lt;!-- below 25 will be NOT-A-MATCH or no category --&gt;</span>
  <span class="nt">&lt;/thresholds&gt;</span>
  <span class="nt">&lt;tuning&gt;</span>
    <span class="nt">&lt;max-scan&gt;</span>200<span class="nt">&lt;/max-scan&gt;</span>
  <span class="nt">&lt;/tuning&gt;</span>
<span class="nt">&lt;/options&gt;</span>
</code></pre></div></div>

<p>And here are the same options in JSON format:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"propertyDefs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">"localname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IdentificationID"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ssn"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">"localname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PersonGivenName"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"first-name"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">"localname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PersonSurName"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"last-name"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"indexReferences"</span><span class="p">:[{</span><span class="s2">"jsonPropertyReference"</span><span class="p">:{</span><span class="s2">"property"</span><span class="p">:</span><span class="s2">"PersonSurName"</span><span class="p">,</span><span class="w"> </span><span class="s2">"scalarType"</span><span class="p">:</span><span class="s2">"string"</span><span class="p">,</span><span class="w"> </span><span class="s2">"collation"</span><span class="p">:</span><span class="s2">"http://marklogic.com/collation//S1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"nullable"</span><span class="p">:</span><span class="kc">false</span><span class="p">}}]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">"localname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AddressPrivateMailboxText"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"addr1"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">"localname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LocationCity"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"city"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">"localname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LocationState"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"state"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">"localname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LocationPostalCode"</span><span class="p">,</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zip"</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"algorithms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"algorithm"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"std-reduce"</span><span class="p">,</span><span class="w"> </span><span class="s2">"function"</span><span class="p">:</span><span class="w"> </span><span class="s2">"standard-reduction"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbl-metaphone"</span><span class="p">,</span><span class="w"> </span><span class="s2">"function"</span><span class="p">:</span><span class="w"> </span><span class="s2">"double-metaphone"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thesaurus"</span><span class="p">,</span><span class="w"> </span><span class="s2">"function"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thesaurus"</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"collections"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"content"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"my-content-collection"</span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"scoring"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"add"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ssn"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"last-name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"first-name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"addr1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"city"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"state"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zip"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"expand"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"first-name"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"algorithmRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thesaurus"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"thesaurus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/mdm/config/thesauri/first-name-synonyms.xml"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"last-name"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"algorithmRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbl-metaphone"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"dictionary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name-dictionary.xml"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"distanceThreshold"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"reduce"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"algorithmRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"std-reduce"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"allMatch"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"last-name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"addr1"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"my-custom-action"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"function"</span><span class="p">:</span><span class="w"> </span><span class="s2">"custom-action"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://marklogic.com/smart-mastering/action"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/custom-action.xqy"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"thresholds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"threshold"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"above"</span><span class="p">:</span><span class="w"> </span><span class="s2">"30"</span><span class="p">,</span><span class="w"> </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Possible Match"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"above"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50"</span><span class="p">,</span><span class="w"> </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Likely Match"</span><span class="p">,</span><span class="w"> </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"notify"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"above"</span><span class="p">:</span><span class="w"> </span><span class="s2">"68"</span><span class="p">,</span><span class="w"> </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Definitive Match"</span><span class="p">,</span><span class="w"> </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"merge"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="s2">"above"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75"</span><span class="p">,</span><span class="w"> </span><span class="s2">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Custom Match"</span><span class="p">,</span><span class="w"> </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"my-custom-action"</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"tuning"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"maxScan"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="property-definitions">Property Definitions</h3>

<p>The <code class="highlighter-rouge">property-defs/property</code> elements identify the elements that will be used to
find matches for a document. Use the <code class="highlighter-rouge">namespace</code> and <code class="highlighter-rouge">localname</code> attributes to
specify an XML element or JSON property. The <code class="highlighter-rouge">name</code> attribute acts as a nickname
for this property in the rest of the configuration.</p>

<p>As of version 1.3.1, index references can be associated with properties by adding XML serialized cts:references under the <code class="highlighter-rouge">property</code> element or adding an array of JSON serialized cts:references as a <code class="highlighter-rouge">indexReferences</code> property of the <code class="highlighter-rouge">property</code> JSON object.</p>

<h3 id="algorithms">Algorithms</h3>

<p>The <code class="highlighter-rouge">algorithms/algorithm</code> elements list additional algorithms you can use to
compare property values. The default approach is comparing for equality. To set
up matching with your custom code, add an <code class="highlighter-rouge">algorithm</code> element with attributes
<code class="highlighter-rouge">name</code>, <code class="highlighter-rouge">function</code>, <code class="highlighter-rouge">namespace</code>, and <code class="highlighter-rouge">at</code>. The <code class="highlighter-rouge">name</code> attribute is used to refer
to this algorithm later in the configuration. The other three attributes are
used to find the code.</p>

<p>For more details, see <a href="../custom-match-algorithms/">Custom Match Algorithms</a>. 
For an example, see <a href="https://github.com/marklogic-community/smart-mastering-core/blob/master/src/main/ml-modules/root/com.marklogic.smart-mastering/algorithms/zip.xqy">zip.xqy</a>.</p>

<h3 id="collections">Collections</h3>

<p>The <code class="highlighter-rouge">collections/content</code> elements can override the default collection used to determine the scope of the dataset being mastered. If multiple <code class="highlighter-rouge">content</code> elements are specified, the dataset is restricted to an intersection of those collections.</p>

<h3 id="scoring">Scoring</h3>

<p>Matches are based on how many properties match, what algorithms are used to
determine matches, and the weights placed on the properties. See the How Scoring
Works section for more information about how match scores are calculated.</p>

<h4 id="add-elements"><code class="highlighter-rouge">add</code> elements</h4>

<p>This section really drives the matching process. For each <code class="highlighter-rouge">add</code> element, the
matcher will add this element or property to the query used to find other
documents that match the candidate document. The <code class="highlighter-rouge">property-name</code> attribute must
match the <code class="highlighter-rouge">name</code> attribute of a <code class="highlighter-rouge">property</code> element defined under
<code class="highlighter-rouge">property-defs</code>. The <code class="highlighter-rouge">weight</code> attribute is the number of points awarded to
a potential match if the values match.</p>

<h4 id="expand-elements"><code class="highlighter-rouge">expand</code> elements</h4>

<p>To apply a different matching strategy, add an <code class="highlighter-rouge">extend</code> element. The
<code class="highlighter-rouge">property-name</code> element must match the <code class="highlighter-rouge">name</code> attribute of a <code class="highlighter-rouge">property</code> element
defined under <code class="highlighter-rouge">property-defs</code>. The <code class="highlighter-rouge">algorithm-ref</code> attribute must match the
<code class="highlighter-rouge">name</code> attribute of an <code class="highlighter-rouge">algorithm</code> element under <code class="highlighter-rouge">algorithms</code>. Sub-elements
under the <code class="highlighter-rouge">extend</code> element depend on the implementation of the function.</p>

<h4 id="reduce-elements"><code class="highlighter-rouge">reduce</code> elements</h4>

<p>In some cases, a combination of matching properties may suggest a match when
there shouldn’t be one. Consider two relatives living together. When matched,
two Person records have the same family name, same street address, city, and zip
code. That might be enough points to trigger a match even though the two given
names differ.</p>

<p>The <code class="highlighter-rouge">reduce</code> element gives a way to back off the scores in such cases. The
<code class="highlighter-rouge">algorithm-ref</code> attribute must match the <code class="highlighter-rouge">name</code> attribute of an <code class="highlighter-rouge">algorithm</code>
element under <code class="highlighter-rouge">algorithms</code>. The <code class="highlighter-rouge">weight</code> attribute will be subtracted from the
score if the algorithm matches.</p>

<h3 id="actions">Actions</h3>

<p>You can provide your own custom action handler functions. Custom actions are called after merge and notify have run. These actions will be called in a separate transaction, so the results of each call will be visible to the actions called after it.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;actions&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">"my-custom-action"</span> <span class="na">function=</span><span class="s">"custom-action"</span> <span class="na">namespace=</span><span class="s">"http://marklogic.com/smart-mastering/action"</span> <span class="na">at=</span><span class="s">"/custom-action.xqy"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/actions&gt;</span>
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"action"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"my-custom-action"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"function"</span><span class="p">:</span><span class="w"> </span><span class="s2">"custom-action"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://marklogic.com/smart-mastering/action"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/custom-action.xqy"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Each custom action can define four properties:</p>
<ul>
  <li><strong>name</strong> - the name of the custom action</li>
  <li><strong>function</strong> - the name of the custom function to invoke</li>
  <li><strong>namespace</strong> - the namespace of the module containing the function</li>
  <li><strong>at</strong> - the uri location of the module containing the function</li>
</ul>

<p>Your custom action will be called with three parameters:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$uri - the uri of the document being matched
$matches - either an array (sjs) or sequence (xqy) of matches
$merge-options - the merge options as xml (for xqy) or json (for sjs)
</code></pre></div></div>

<p>For more information on custom actions, see <a href="../custom-actions">Custom Actions</a></p>

<h3 id="thresholds">Thresholds</h3>

<p>Smart-mastering-core can be configured to take different actions based on the
match scores. Each <code class="highlighter-rouge">threshold</code> element has an <code class="highlighter-rouge">above</code> attribute, which is the
minimum absolute score a match must have against the candidate document in order
to reach that threshold. A <code class="highlighter-rouge">threshold</code> element may also have a <code class="highlighter-rouge">label</code> attribute
and an <code class="highlighter-rouge">action</code> attribute. If the <code class="highlighter-rouge">action</code> attribute is “merge”, then the
candidate document and any document that reaches this threshold will be
automatically merged. For <code class="highlighter-rouge">action="notify"</code>, a notification will be recorded
for a human reviewer.</p>

<h3 id="tuning">Tuning</h3>

<p>The <code class="highlighter-rouge">max-scan</code> element limits the number of potential matches that get
processed. In the example configuration with <code class="highlighter-rouge">&lt;max-scan&gt;200&lt;/max-scan&gt;</code>,
only the top 200 scoring potential matches will be merged or have notifications
recorded.</p>

<h2 id="how-scoring-works">How Scoring Works</h2>

<p>High scores are relative to the configuration, rather than measured on an
absolute scale. The maximum possible score is the sum of the weights of all of
the weight attributes.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;scoring&gt;</span>
  <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"ssn"</span> <span class="na">weight=</span><span class="s">"50"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"last-name"</span> <span class="na">weight=</span><span class="s">"8"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"first-name"</span> <span class="na">weight=</span><span class="s">"6"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"addr1"</span> <span class="na">weight=</span><span class="s">"5"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"city"</span> <span class="na">weight=</span><span class="s">"3"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"state"</span> <span class="na">weight=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;add</span> <span class="na">property-name=</span><span class="s">"zip"</span> <span class="na">weight=</span><span class="s">"3"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;expand</span> <span class="na">property-name=</span><span class="s">"first-name"</span> <span class="na">algorithm-ref=</span><span class="s">"thesaurus"</span> <span class="na">weight=</span><span class="s">"6"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;thesaurus&gt;</span>/mdm/config/thesauri/first-name-synonyms.xml<span class="nt">&lt;/thesaurus&gt;</span>
    <span class="nt">&lt;distance-threshold&gt;</span>50<span class="nt">&lt;/distance-threshold&gt;</span>
  <span class="nt">&lt;/expand&gt;</span>
  <span class="nt">&lt;expand</span> <span class="na">property-name=</span><span class="s">"last-name"</span> <span class="na">algorithm-ref=</span><span class="s">"dbl-metaphone"</span> <span class="na">weight=</span><span class="s">"8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;dictionary&gt;</span>name-dictionary.xml<span class="nt">&lt;/dictionary&gt;</span>
    <span class="c">&lt;!--defaults to 100 distance --&gt;</span>
  <span class="nt">&lt;/expand&gt;</span>
  <span class="nt">&lt;reduce</span> <span class="na">algorithm-ref=</span><span class="s">"std-reduce"</span> <span class="na">weight=</span><span class="s">"4"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;all-match&gt;</span>
      <span class="nt">&lt;property&gt;</span>last-name<span class="nt">&lt;/property&gt;</span>
      <span class="nt">&lt;property&gt;</span>addr1<span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;/all-match&gt;</span>
  <span class="nt">&lt;/reduce&gt;</span>
<span class="nt">&lt;/scoring&gt;</span>
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">    </span><span class="s2">"scoring"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="s2">"add"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ssn"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50"</span><span class="w"> </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"last-name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8"</span><span class="w"> </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"first-name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12"</span><span class="w"> </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"addr1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5"</span><span class="w"> </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"city"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="w"> </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"state"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w"> </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w"> </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"zip"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="w"> </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"expand"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"first-name"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"algorithmRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thesaurus"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"thesaurus"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/mdm/config/thesauri/first-name-synonyms.xml"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"distanceThreshold"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"last-name"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"algorithmRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbl-metaphone"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dictionary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name-dictionary.xml"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"reduce"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"algorithmRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"std-reduce"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"allMatch"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"property"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"last-name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"addr1"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>In the example configuration above, the maximum possible score is
50+8+6+5+3+1+3+6+8-4=86. Thresholds must be adjusted based on these values.</p>

<p>This process is run as a normal search, which control over the scoring. For more
information about how search works in MarkLogic, see <a href="http://docs.marklogic.com/guide/performance/unfiltered#id_13165">Understanding the Search
Process</a>. The match process uses the simple scoring
option, with the property weight controlling how much influence each should
have. To read more about how scoring works in MarkLogic, see <a href="http://docs.marklogic.com/guide/search-dev/relevance#chapter">Relevance Scores:
Understanding and Customizing</a>.</p>

<h2 id="saving-options">Saving Options</h2>

<p>Matching options may be stored before starting the matching process. Doing so
means that the client layer does not need to store and maintain the options.</p>

<h3 id="rest">REST</h3>

<p>To save match options using REST, POST them to <code class="highlighter-rouge">/v1/resource/sm-match-options</code>
with <code class="highlighter-rouge">rs:name</code> as a URL parameter and the options in the body of the request.</p>

<h3 id="xquerysjs">XQuery/SJS</h3>

<p>To save match options using XQuery, import <code class="highlighter-rouge">matcher.xqy</code> and call the
<code class="highlighter-rouge">matcher:save-options</code> function.</p>


        </div>
      </div>
    </div>
  </article>


    <footer class="site-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <p>
                    Copyright © 2016-2019 MarkLogic Corporation. All Rights Reserved. MARKLOGIC® is a registered trademark of MarkLogic Corporation.
                    </p>
                </div>
            </div>
        </div>
    </footer>


    <!--[if lt IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="/smart-mastering-core/js/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="/smart-mastering-core/assets/bundle.js" id="1"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-79716597-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>

